#!/usr/bin/env bash
set -ex

# A manual test for framed_decode.

REPO_DIR="$(cd $(dirname ${BASH_SOURCE[0]} )/..; pwd )"
cd ${REPO_DIR};

TC=${TC?Supply a toolchain in this environment variable}

export DECODE_TYPE_CRATE_DIR=${REPO_DIR}/test_type
export DECODE_TYPE_NAME=framed_test_type::Test
export TC

cargo +${TC} run -p framed_test_type > target/test_output;
cat target/test_output | hd;
cat target/test_output | ${REPO_DIR}/bin/decode_typed;
seq 5 | xargs -I% cat target/test_output | ${REPO_DIR}/bin/decode_typed;
